<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Janssen Maquinaria | Solicitud de Mantención</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap -->
    <link 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" 
        rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="../css/styles.css">
</head>

<body class="d-flex flex-column min-vh-100">

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
        <img src="../assets/img/Janssen MAQ.png" class="login-logo" alt="Janssen Maquinaria">


        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#menu">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="menu">
            <ul class="navbar-nav me-auto">
                <li class="nav-item"><a class="nav-link" href="home.html">Inicio</a></li>
                <li class="nav-item">
                    <a class="nav-link " href="perfil.html">Perfil</a>
                </li>
                <li class="nav-item"><a class="nav-link" href="maquinarias.html">Maquinarias</a></li>
                <li class="nav-item"><a class="nav-link active" href="mantencion.html">Solicitud Mantención</a></li>
                <li class="nav-item">
                        <a class="nav-link" href="https://www.duromaxpower.com/collections/generators">Repuestos</a>
                </li>
            </ul>

            <span class="navbar-text text-white">
                                    Bienvenido, Constructora Andes | 76.123.456-7

            </span>
        </div>

    </div>
</nav>

<!-- MAIN -->
<main class="flex-fill " style="background-color: rgb(238, 238, 241);" >
  <div class="container py-4 ">
    <div class="row justify-content-center ">
      <!-- Ajusta el ancho aquí (más angosto o más ancho) -->
      <div class="col-12 col-md-10 col-lg-6 col-xl-7 ">

        <!-- Tarjeta centrada -->
        <div class="card shadow-sm border-0 ">
          <div class="card-body p-4 p-md-5 ">

            <h4 class="mb-4">Solicitud de Mantención</h4>

            <form class="row g-3 needs-validation"  novalidate id="formMantencion">

              <!-- FILA 1: MAQUINARIA (izq) - TIPO (der) -->

              <!-- MAQUINARIA -->
              <div class="col-md-6">
                <label class="form-label" for="maquinaria">Maquinaria</label>
                <select class="form-select" id="maquinaria" required>
                  <option value="">Seleccione...</option>
                  <option value="580SV">Janssen 580SV</option>
                  <option value="821G">Janssen 821G</option>
                </select>
                <div class="invalid-feedback">
                  Debe seleccionar una maquinaria.
                </div>
              </div>

              <!-- TIPO DE MANTENCIÓN (condicional) -->
              <div class="col-md-6">
                <label class="form-label">Tipo de mantención</label>

                <div class="d-flex flex-column gap-2">

                  <!-- Primera mantención (opción aparte) -->
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipoMantencion" id="tipoPrimera" value="primera" required>
                    <label class="form-check-label" for="tipoPrimera">
                      Primera mantención (4000 horas)
                    </label>
                  </div>

                  <!-- Correctiva (opción aparte) -->
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipoMantencion" id="tipoCorrectiva" value="correctiva" required>
                    <label class="form-check-label" for="tipoCorrectiva">
                      Mantención correctiva (reparación)
                    </label>
                  </div>

                  <!-- Preventiva -->
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipoMantencion" id="tipoPreventiva" value="preventiva" required>
                    <label class="form-check-label" for="tipoPreventiva">
                      Mantención preventiva
                    </label>
                  </div>

                  <!-- Desplegable SOLO para subtipos preventivos (se muestra solo si Preventiva está seleccionada) -->
                  <div id="preventivaExtraWrap" class="mt-2 d-none">
                    <select class="form-select" id="preventivaExtra">
                      <option value="">Seleccione tipo preventivo...</option>
                      <option value="prev_general">Preventiva general</option>
                      <option value="prev_filtros">Cambio de filtros</option>
                      <option value="prev_aceite">Cambio de aceite</option>
                    </select>
                    <div class="form-text">
                      Solo aplica si seleccionas <strong>mantención preventiva</strong>.
                    </div>
                  </div>

                </div>

                <div class="invalid-feedback">
                  Seleccione un tipo de mantención.
                </div>
              </div>

              <!-- FILA 2: HORAS (izq) - SUCURSAL (der) -->

              <!-- HORAS -->
              <div class="col-md-6">
                <label class="form-label" for="horas">Horas de operación</label>
                <input type="number" class="form-control" id="horas" placeholder="Ej: 4000" min="0" required>
                <div class="invalid-feedback">
                  Ingrese horas de operación.
                </div>
                <div class="form-text" id="horasHint"></div>
              </div>

              <!-- SUCURSAL -->
              <div class="col-md-6">
                <label class="form-label" for="sucursal">Sucursal</label>
                <select class="form-select" id="sucursal" required>
                  <option value="">Seleccione...</option>
                  <option>Antofagasta</option>
                  <option>Santiago</option>
                  <option>Concepción</option>
                  <option>Temuco</option>
                  <option>Osorno</option>
                </select>
                <div class="invalid-feedback">
                  Seleccione una sucursal.
                </div>
              </div>

              <!-- FILA 3: FECHA (izq) -->
              <div class="col-md-6">
                <label class="form-label" for="fecha">Fecha preferida</label>
                <input type="date" class="form-control" id="fecha" required>
                <div class="invalid-feedback">
                  Seleccione una fecha.
                </div>
              </div>

              <!-- espacio para mantener grilla alineada -->
              <div class="col-md-6 d-none d-md-block"></div>

              <!-- FILA 4: OBSERVACIONES -->
              <div class="col-12">
                <label class="form-label" for="obs">Observaciones (opcional)</label>
                <textarea class="form-control" id="obs" rows="3"></textarea>
              </div>

              <!-- BOTÓN -->
              <div class="col-12 d-grid mt-3">
                <button class="btn btn-danger" type="submit">
                  Agendar Mantención
                </button>
              </div>

            </form>

          </div>
        </div>

      </div>
    </div>
  </div>
</main>

<script>
  (function () {
    const form = document.getElementById('formMantencion');

    const tipoPrimera = document.getElementById('tipoPrimera');
    const tipoCorrectiva = document.getElementById('tipoCorrectiva');
    const tipoPreventiva = document.getElementById('tipoPreventiva');

    const preventivaExtraWrap = document.getElementById('preventivaExtraWrap');
    const preventivaExtra = document.getElementById('preventivaExtra');

    const horasHint = document.getElementById('horasHint');

    function aplicarCondicionTipo() {
      horasHint.textContent = '';

      if (tipoPrimera.checked) {
        preventivaExtraWrap.classList.add('d-none');
        preventivaExtra.value = '';
        horasHint.textContent = 'Para Primera Mantención, normalmente corresponde a 4000 horas.';
      }

      if (tipoCorrectiva.checked) {
        preventivaExtraWrap.classList.add('d-none');
        preventivaExtra.value = '';
        horasHint.textContent = 'Para Correctiva, ingrese las horas actuales de operación.';
      }

      if (tipoPreventiva.checked) {
        preventivaExtraWrap.classList.remove('d-none');
        horasHint.textContent = 'Para Preventiva, ingrese las horas actuales de operación.';
      }
    }

    [tipoPrimera, tipoCorrectiva, tipoPreventiva].forEach(r => {
      r.addEventListener('change', aplicarCondicionTipo);
    });

    // Validación Bootstrap
    form.addEventListener('submit', function (event) {
      // Si quieres exigir que el select preventivo se elija cuando es Preventiva,
      // descomenta este bloque:
      // if (tipoPreventiva.checked && !preventivaExtra.value) {
      //   preventivaExtra.setCustomValidity('Seleccione un tipo preventivo');
      // } else {
      //   preventivaExtra.setCustomValidity('');
      // }

      if (!form.checkValidity()) {
        event.preventDefault();
        event.stopPropagation();
      }
      form.classList.add('was-validated');
    }, false);
  })();
</script>

    <!-- FOOTER -->
    <footer class="footer-marcas mt-5">
        <div class="marcas-container">
            <div class="marcas-track">

                <img src="../assets/img/case.jpg" alt="Janssen">
                <img src="../assets/img/case2.png" alt="Janssen">
                <img src="../assets/img/case.jpg" alt="Janssen">
                <img src="../assets/img/case2.png" alt="Janssen">
                <img src="../assets/img/case.jpg" alt="Janssen">
                <img src="../assets/img/case2.png" alt="Janssen">
                

            </div>
        </div>

        <div class="footer-text">
            ALEXANDER AGUILERA · Todos los derechos reservados
        </div>
    </footer>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
(() => {
  'use strict'
  const forms = document.querySelectorAll('.needs-validation')

  Array.from(forms).forEach(form => {
    form.addEventListener('submit', event => {
      if (!form.checkValidity()) {
        event.preventDefault()
        event.stopPropagation()
      } else {
        event.preventDefault()
        window.location.href = "confirmacion.html"
      }
      form.classList.add('was-validated')
    }, false)
  })
})()
</script>

</body>
</html>
